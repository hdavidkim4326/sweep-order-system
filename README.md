# 📦 스윕농장 발주 통합 시스템 (Sweep Order System)

![Version](https://img.shields.io/badge/version-1.0.0-orange.svg)
![React](https://img.shields.io/badge/React-18-61DAFB.svg)
![TypeScript](https://img.shields.io/badge/TypeScript-5.0-3178C6.svg)
![Vite](https://img.shields.io/badge/Vite-6.0-646CFF.svg)
![TailwindCSS](https://img.shields.io/badge/TailwindCSS-3.0-38B2AC.svg)

여러 판매처(진케어, 담아, 산지명인 등)로부터 받는 **제각각인 엑셀 주문서**를 **단 하나의 통합 양식**으로 자동 변환해주는 웹 서비스입니다.
수작업으로 진행하던 발주 정리 시간을 단축하고, 휴먼 에러를 방지하며, **새로운 거래처가 추가되어도 코드 수정 없이 대응 가능한 확장성**을 갖추었습니다.

### 🖥️ 실행 화면
![메인 대시보드](./image_56083f.png)

---

## 1. 실행 방법 (How to Run)

### 설치 (Installation)
프로젝트 폴더에서 의존성 패키지를 설치합니다.
```bash
npm install
```

### 실행 (Run)
개발 서버를 실행합니다.
```bash
npm run dev
```
브라우저에서서 http://localhost:5173을 입력하여 접속합니다.
---

## 2. 접근 방식 (설계 및 구현 과정)

과제의 필수 요구사항뿐만 아니라, **"새로운 판매처나 상품명이 생기면 어떻게 처리할까?"**라는 질문에 대한 근본적인 해결책을 제시하는 방향으로 설계했습니다.

### 1) 확장 가능한 매핑 시스템 (⭐ 핵심적 고안 사항)
가장 깊게 고민했던 부분은 **'유지보수성'**입니다. 매핑 규칙을 상수로 하드코딩하면, 새로운 거래처가 생길 때마다 개발자가 코드를 수정하고 재배포해야 하는 비효율이 발생합니다.

* **해결책:** 현업 담당자 또는 고객이 웹 UI에서 직접 매핑 규칙을 추가하고 관리할 수 있는 **[매핑 설정 관리자]** 기능을 개발했습니다.
* **기술 구현:**
    * 매핑 규칙을 `Zustand` 전역 상태로 관리하며, `persist` 미들웨어를 통해 **브라우저 저장소(LocalStorage)에 영구 저장**됩니다.
    * 새로고침 하거나 브라우저를 껐다 켜도 사용자가 설정한 커스텀 규칙이 그대로 유지됩니다.

| 헤더(컬럼) 매핑 설정 | 상품명 변환 규칙 설정 |
| :---: | :---: |
| ![헤더 매핑 설정](./image_6f74cb.png) | ![상품명 변환 설정](./image_6f878a.png) |
| *새로운 엑셀 헤더가 등장하면 즉시 추가 가능* | *복잡한 상품명을 표준 코드로 자동 변환* |

### 2) 파일 업로드 및 데이터 처리
* **xlsx, xls 완벽 지원:** `SheetJS(xlsx)` 라이브러리를 사용하여 다양한 엑셀 포맷을 파싱합니다.
* **중복 방지 시스템:** 파일명과 데이터를 기반으로 중복 업로드를 감지하고, 사용자에게 확인(Confirm)을 거쳐 데이터 무결성을 보장합니다.
* **UX 최적화:** Drag & Drop 지원 및 직관적인 파일 목록 관리를 통해, 여러 개의 파일을 손쉽게 병합하고 관리할 수 있습니다.

### 3) 지능형 데이터 변환 (열 매핑 및 상품명 정규화화)
* **열 매핑핑:** `수령인 전화`, `수령인전화`와 같은 띄어쓰기 차이, 혹은 `수취인명` 같은 유사어를 자동으로 표준 필드(`contact`)로 연결합니다.
* **상품명 정규화:** `[산지명인] 구운란`, `동물복지 구운란` 등 다양한 상품명을 설정된 규칙에 따라 `구운란 30구`라는 표준 코드로 치환합니다.

### 4) 미리보기 및 다운로드
* **미리보기기:** 변환된 데이터를 미리보기 화면에서 확인할 수 있습니다.
* **실시간 필터링:** 미리 보기 화면에서 수백 건의 주문 데이터 중 원하는 건을 즉시 찾을 수 있도록 `수령인`, `주소`, `상품명` 복합 검색 기능을 제공합니다.
* **표준 양식 출력:** 내부적으로 병합된 데이터를 과제에서 요구한 **정규화된 OUTPUT 발주 양식** 순서(`수령인`, `연락처`, `우편번호`...)에 맞춰 재정렬한 후 `.xlsx` 파일로 생성합니다.
---

## 3. 어려웠던 점 & 해결 과정 



### 1. 헤더 매핑의 정확도
* **문제:** 엑셀 파일의 `수령인 전화` 헤더와 코드상의 `수령인` 키워드가 있을 때, 단순 `includes` 로직을 사용하면 `수령인 전화`가 `수령인`으로 잘못 인식(오매칭)되는 문제가 있었습니다. 또한 `수령인전화`와 같이 띄어쓰기가 없는 경우도 처리해야 했습니다.
* **해결:**
    1.  비교 전 모든 문자열의 **공백을 제거(`replace(/\s+/g, '')`)**하여 띄어쓰기 불일치 문제를 해결했습니다.
    2.  **완전 일치(Exact Match)**를 우선 수행하여 정확한 매핑을 찾고, 실패할 경우에만 **부분 일치(Fuzzy Match)**를 수행하는 2단계 매칭 우선순위 로직을 구현하여 정확도를 100%로 높였습니다.

### 2. 데이터 덮어쓰기 방지 (Data Integrity)
* **문제:** 특정 업체(예: 진케어) 파일 구조상 유효한 상품명이 있는 컬럼 뒤에, 이름은 같지만 값이 비어있는 불필요한 컬럼(Ghost Column)이 존재했습니다. 이로 인해 파싱 과정에서 빈 값이 유효한 데이터를 덮어쓰는 버그가 발견되었습니다.
* **해결:** 데이터를 병합하는 과정에서 **"기존에 값이 존재하고, 새로 들어오는 값이 비어있다면 업데이트를 건너뛴다(Skip)"**는 방어 로직(Defensive Coding)을 추가하여 데이터 소실을 막았습니다.

### 3. 대용량 처리를 고려한 상태 관리 최적화
* **고민:** 사용자의 매핑 설정을 유지하기 위해 `LocalStorage` 저장을 구현했습니다. 하지만 테스트 파일(300행 미만)과 달리, 실제 현업 데이터가 수천 행 이상으로 커질 경우 엑셀 데이터까지 전부 로컬 스토리지에 저장하면 **용량 초과 오류**가 발생할 위험이 있음을 인지했습니다.
* **해결:** `src/store/orderStore.ts`에서 Zustand의 `persist` 미들웨어를 사용할 때 `partialize` 옵션을 적용했습니다. 이를 통해 용량이 큰 엑셀 데이터(`files`, `masterData`)는 제외하고, **가벼운 설정값(`headerMappings`, `productRules`)만 선별적으로 저장**하도록 설계하여 잠재적인 런타임 오류를 사전에 차단했습니다.

### 4. 확장성을 고려한 아키텍처 리팩토링 (하드코딩 → 동적 시스템)
* **문제:** 초기 개발 단계에서는 `src/lib/constants.ts` 파일에 매핑 규칙을 상수로 정의(하드코딩)했습니다. 하지만 과제의 "새로운 판매처나 상품명이 생기면 어떻게 할 것인가?"라는 질문을 고민해보니, 이 방식은 새로운 거래처가 생길 때마다 **개발자가 매번 코드를 수정하고 재배포**해야 하는 비효율적인 구조임을 깨달았습니다.
* **해결:** 시스템 구조를 완전히 개편하여 **[매핑 설정 관리자]** 기능을 개발했습니다.
    1. 상수로 관리하던 규칙을 `Zustand`의 **전역 상태(State)**로 변경하여 런타임에 수정 가능하도록 만들었습니다.
    2. `src/components/SettingsModal.tsx`를 구현하여, 개발 지식이 없는 현업 담당자도 UI에서 직접 "수취인 핸드폰" 같은 새로운 헤더를 "연락처" 필드에 연결할 수 있게 만들었습니다.
    3. 결과적으로 개발자의 개입 없이 운영팀이 스스로 변화에 대응할 수 있는 **지속 가능한 시스템**을 구축했습니다.
---

## 4. 개선 아이디어

시간이 더 주어졌다면 다음 기능들을 추가하여 시스템을 더욱 고도화하고 싶습니다.

1.  **설정값 서버 동기화 (Backend Integration)**
    * 현재 구현된 [매핑 설정 관리자]는 브라우저에 저장되므로 개인화되어 있습니다. 이를 백엔드 DB와 연동하여 **팀원 전체가 동일한 매핑 규칙을 공유**할 수 있도록 개선하고 싶습니다.
2.  **데이터 검증 시각화 (Validation UI)**
    * 전화번호 형식이 잘못되었거나(`010-1234`), 필수 주소가 누락된 셀을 감지하여 **빨간색 하이라이팅**으로 표시하고, 툴팁으로 오류 내용을 안내하여 발주 사고를 미연에 방지하는 기능을 추가하고 싶습니다.
3.  **대용량 처리 최적화 (Web Worker)**
    * 현재는 메인 스레드에서 엑셀 파싱을 수행하지만, 파일이 수만 건 이상으로 커질 경우 UI가 일시적으로 멈출 수 있습니다. 파싱 로직을 **Web Worker**로 분리하여 백그라운드에서 처리함으로써 UI 반응성을 유지하고 싶습니다.

---

## 📂 프로젝트 구조 

```bash
src/
├── lib/
│   ├── constants.ts     # 매핑 키워드 및 정규화 규칙 정의 (Default값)
│   └── excelHandler.ts  # 엑셀 파싱, 공백 제거, 데이터 변환 핵심 로직
├── store/
│   └── orderStore.ts    # Zustand 전역 상태 관리 (설정값 Persist 저장)
├── components/
│   └── SettingsModal.tsx # 매핑 규칙 관리자 UI (설정 추가/삭제)
├── types/
│   └── index.ts         # TypeScript 인터페이스 정의 (MasterOrder, UploadedFile)
├── App.tsx              # 메인 대시보드 UI 및 비즈니스 로직 연결
└── main.tsx             # 앱 진입점