# 📦 스윕농장 발주 통합 시스템 (Sweep Order System)

![Version](https://img.shields.io/badge/version-1.0.0-orange.svg)
![React](https://img.shields.io/badge/React-18-61DAFB.svg)
![TypeScript](https://img.shields.io/badge/TypeScript-5.0-3178C6.svg)
![Vite](https://img.shields.io/badge/Vite-6.0-646CFF.svg)

여러 판매처(진케어, 담아, 산지명인 등)로부터 받는 **제각각인 엑셀 주문서**를 **단 하나의 통합 양식**으로 자동 변환해주는 웹 서비스입니다.
수작업으로 진행하던 발주 정리 시간을 단축하고, 휴먼 에러를 방지하기 위해 개발되었습니다.

---

## 1. 실행 방법 (How to Run)

### 설치 (Installation)
프로젝트 폴더에서 의존성 패키지를 설치합니다.
```bash
npm install
```

### 실행 (Run)
개발 서버를 실행합니다.
```bash
npm run dev
```

---

## 2. 접근 방식 (Approach)

과제의 필수 요구사항을 충족하기 위해 다음과 같이 설계 및 구현했습니다.

### 1) 파일 업로드
* **xlsx, xls 완벽 지원:** `SheetJS(xlsx)` 라이브러리를 사용하여 다양한 엑셀 형식을 파싱합니다.
* **Drag & Drop 및 다중 업로드:** 사용 편의성을 위해 여러 파일을 한 번에 드래그하여 업로드할 수 있는 직관적인 UI를 구현했습니다.
* **중복 방지 로직:** 동일한 파일이 중복으로 업로드될 경우, 사용자에게 알림(Confirm)을 띄워 중복 추가 여부를 결정하게 하여 데이터 중복을 방지했습니다.

### 2) 열 매핑 (Column Mapping)
* **지능형 헤더 매핑:** 거래처마다 다른 헤더 이름(예: `수령인`, `받는분`, `수취인명`)을 표준 양식인 `수령인`으로 자동 연결합니다.
* **공백 무시 매칭:** `수령인 전화`와 `수령인전화` 처럼 띄어쓰기 차이로 인해 인식이 안 되는 문제를 해결하기 위해, 내부적으로 모든 공백을 제거하고 비교하는 로직을 적용했습니다.

### 3) 미리보기 (Preview)
* **실시간 데이터 확인:** 업로드 즉시 변환된 데이터를 엑셀 스타일의 그리드 뷰(Grid View)로 보여줍니다.
* **검색 기능:** 수백 건의 데이터 중 특정 주문을 찾기 쉽도록 `수령인`, `주소`, `상품명` 기준 실시간 필터링(Ctrl+F 대체) 기능을 구현했습니다.

### 4) 다운로드 (Download)
* **표준 양식 변환:** 통합된 데이터를 과제에서 요구한 **한진택배 발주 양식** 순서(`수령인`, `연락처`, `우편번호`...)에 맞춰 정확하게 정렬하여 `.xlsx` 파일로 생성합니다.

### 5) 상품명 정규화 (Normalization)
* **표준화 로직 적용:** `[산지명인] 반숙란 30구`, `동물복지 구운란 20구` 등 다양한 상품명을 `반숙란 30구`와 같은 표준 코드로 치환합니다.
* **확장성 고려:** `constants.ts` 파일에 매핑 규칙(`PRODUCT_NORMALIZATION_RULES`)을 분리하여, 새로운 상품명이 생겼을 때 코드 수정 없이 규칙만 추가하면 되도록 설계했습니다.

### ➕ 추가 구현 (Bonus Features)
* **사용자 온보딩 가이드:** 처음 접속한 사용자가 당황하지 않도록 우측 상단 `?` 버튼을 통해 인터랙티브 사용 가이드를 제공합니다.
* **개별 파일 관리:** 업로드된 파일 목록을 별도로 보여주고, 특정 파일만 삭제하거나 원본을 다시 다운로드할 수 있는 관리 기능을 추가했습니다.

---

## 3. 어려웠던 점 & 해결 과정 (Challenges & Solutions)

### 1. 헤더 매핑의 정확도 문제 (공백 및 유사어 이슈)
* **문제:** 엑셀 파일의 `수령인 전화` 헤더가 코드상의 키워드 `수령인전화`와 달라서 인식이 안 되는 현상이 발생했습니다. 또한 `포함(includes)` 로직만 사용할 경우 `수령인 전화`가 `수령인` 키워드에 먼저 매칭되어 데이터가 꼬이는 문제가 있었습니다.
* **해결:**
    1. 헤더 비교 시 양쪽의 **공백을 모두 제거(`replace(/\s+/g, '')`)**한 후 비교하도록 수정했습니다.
    2. 매칭 우선순위를 두어, **정확히 일치(Exact Match)**하는 것을 먼저 찾고, 없으면 **포함 여부(Fuzzy Match)**를 검사하도록 로직을 개선하여 정확도를 100%로 높였습니다.

### 2. 데이터 덮어쓰기(Overwrite) 방지
* **문제:** 특정 업체(진케어) 파일의 경우, 유효한 데이터가 있는 `품명` 컬럼 뒤에 빈 값인 `옵션` 컬럼이 존재했습니다. 이로 인해 파싱 과정에서 상품명이 빈 값으로 덮어써지는 버그가 있었습니다.
* **해결:** 데이터를 병합할 때 **"기존 값이 존재하고, 새로운 값이 비어있다면 업데이트를 건너뛰는"** 방어 로직을 추가하여 데이터 소실을 막았습니다.

### 3. 동일 파일 재업로드 불가 (Input 버그)
* **문제:** `<input type="file">`은 동일한 파일을 다시 선택하면 `value`가 변경되지 않아 `onChange` 이벤트가 발생하지 않는 브라우저 특성이 있었습니다. 이로 인해 사용자가 실수로 닫은 파일을 다시 올리려 할 때 반응하지 않았습니다.
* **해결:** `onChange` 핸들러 마지막에 `e.target.value = ''`로 **입력값을 초기화**해주는 코드를 추가하여, 연속으로 같은 파일을 선택해도 이벤트가 정상적으로 발생하도록 수정했습니다.

---

## 4. 개선 아이디어 (Improvement Ideas)

시간이 더 주어졌다면 다음과 같은 기능들을 추가하여 시스템을 고도화하고 싶습니다.

1.  **매핑 규칙 관리자 페이지 (Admin Page)**
    * 현재는 새로운 판매처나 상품명이 생기면 코드를 수정해야 합니다. 이를 개선하여, **사용자가 화면에서 직접** "이 헤더는 '수령인'으로 연결해줘"라고 설정을 추가하고 저장할 수 있는 기능을 만들고 싶습니다.
2.  **대용량 처리 최적화 (Web Worker)**
    * 현재는 메인 스레드에서 엑셀을 파싱하지만, 파일이 수만 건 이상으로 커지면 화면이 멈출 수 있습니다. **Web Worker**를 도입하여 파싱 작업을 백그라운드에서 처리해 UI 성능을 확보하고 싶습니다.
3.  **데이터 검증 (Validation) 강화**
    * 전화번호 형식이 맞지 않거나, 필수 주소가 누락된 경우 해당 셀을 **빨간색으로 하이라이팅**하고 "수정 필요" 알림을 주는 기능을 추가하여 발주 사고를 미리 막고 싶습니다.

---

## 📂 프로젝트 구조

```bash
src/
├── lib/
│   ├── constants.ts     # 매핑 키워드 및 정규화 규칙 (설정 파일)
│   └── excelHandler.ts  # 엑셀 파싱 및 데이터 변환 핵심 로직
├── store/
│   └── orderStore.ts    # Zustand 전역 상태 관리
├── components/          # UI 컴포넌트
├── App.tsx              # 메인 UI 및 비즈니스 로직 연결
└── main.tsx             # 앱 진입점